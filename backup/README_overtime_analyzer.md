# 초과근무 분석기

이 프로그램은 사무실 경비 시스템 기록과 초과근무 기록을 비교 분석하여, 경비가 작동 중일 때(사무실에 아무도 없을 때) 특정 직원의 초과근무 기록이 있는 의심스러운 사례를 찾습니다.

## 주요 기능

- 두 개의 엑셀 파일(경비 기록, 초과근무 기록) 동시 분석
- 평일 9:00-18:00를 정상 근무시간으로 간주하고 초과근무 시간 자동 계산
- 새벽 4시를 기준으로 근무일 구분 (예: 13일 7시 경비해제, 14일 2시 경비시작은 13일 근무로 처리)
- 경비 시스템이 작동 중(세팅된 상태)일 때 초과근무 기록이 있는 의심스러운 사례 식별
- 직원별, 부서별 분석 결과 제공
- 휴일 근무 자동 감지 및 처리
- 분석 결과를 엑셀 파일로 내보내기
- 열 이름 자동 감지 기능 (발생일자, 발생시각, 모드 등)

## 데이터 분석 로직

1. **경비 기록 분석**

   - '출근'/'해제'는 경비해제(사무실에 사람이 있음)로 해석
   - '퇴근'/'세팅'/'세트'는 경비시작(사무실에 아무도 없음)으로 해석
   - '출입' 기록은 컨텍스트(해당 날짜의 첫 번째/마지막 기록)에 따라 경비해제 또는 시작으로 해석
   - 새벽 4시를 기준으로 업무일 구분 (예: 5월 14일 2시는 5월 13일 업무일로 처리)
   - 업무일별로 경비 상태 변화 추적 및 시간대 구간 생성

2. **초과근무 기록 분석**

   - 정규 근무시간(9:00-18:00) 외 시간을 초과근무로 처리
   - 이른 아침 출근(9시 이전)과 늦은 저녁 퇴근(18시 이후) 모두 초과근무로 간주
   - 새벽 4시 이전 근무는 전날 업무일로 처리
   - 휴일 근무는 전체 시간을 초과근무로 계산
   - 출/퇴근 시간이 누락된 기록은 자동 감지하여 별도 처리

3. **경비-초과근무 비교 분석**
   - 경비가 활성화된 시간대(경비 세팅 중)에 초과근무 기록이 있는 사례 식별
   - 의심 구간 계산: 경비 활성화 시간과 초과근무 시간의 겹치는 구간
   - 의심 시간 표시: 총 의심 시간 및 해당 시간대 정보 제공
   - 휴일 여부 정보 추가 (휴일 초과근무 vs 평일 초과근무)

## 사용 방법

1. "경비 기록 엑셀 파일 선택" 버튼을 클릭하여 경비 시스템 기록 파일을 선택합니다.
2. "초과근무 기록 엑셀 파일 선택" 버튼을 클릭하여 초과근무 기록 파일을 선택합니다.
3. 필요한 경우 분석할 날짜 범위를 설정합니다.
4. "분석 시작" 버튼을 클릭하여 데이터 분석을 시작합니다.
5. 의심스러운 초과근무 기록이 표에 표시됩니다.
6. "결과 내보내기" 버튼을 클릭하여 분석 결과를 엑셀 파일로 저장합니다.

## 필요한 엑셀 파일 형식

### 경비 기록 파일

- '발생일자' 또는 '날짜'가 포함된 열 (자동 감지, 기본값: A열)
- '발생시각' 또는 '시간'이 포함된 열 (자동 감지, 기본값: B열)
- '모드', '상태' 또는 '내용'이 포함된 열 (자동 감지, 기본값: I열)
- 해당 열에는 다음과 같은 패턴이 포함되어야 함:
  - 경비 해제: '출근', '해제' 등의 키워드 포함
  - 경비 시작: '퇴근', '세팅', '세트' 등의 키워드 포함
  - 출입 기록: '출입' 키워드 포함 (컨텍스트에 따라 자동 분류)

### 초과근무 기록 파일

- 3행부터 데이터가 시작됨 (1-2행은 헤더 정보)
- G열(7열): 초과근무일자
- H열(8열): 출근시간
- I열(9열): 퇴근시간
- D열(4열): 성명(직원명)
- A열(1열): 부서명
- B열(2열): 직급
- F열(6열): 휴일여부
- N열(14열): 근무내용

## 설치 및 실행

### 방법 1: 실행 파일 사용 (권장)

1. GitHub 릴리스 페이지에서 최신 버전의 "overtime_analyzer.exe" 파일을 다운로드합니다.
2. 다운로드한 파일을 더블클릭하여 실행합니다.

### 방법 2: 소스 코드에서 실행 (개발자용)

1. Python과 필요한 라이브러리를 설치합니다:

   ```
   pip install -r requirements.txt
   ```

2. 프로그램을 실행합니다:

   ```
   python overtime_analyzer.py
   ```

3. 윈도우용 실행 파일을 빌드하려면:
   ```
   python build.py
   ```
