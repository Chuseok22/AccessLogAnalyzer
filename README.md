# 초과근무 분석기 (Overtime Analyzer)

이 프로그램은 사무실 경비 시스템 기록과 초과근무 기록을 비교 분석하여, 경비가 작동 중일 때(사무실에 아무도 없을 때) 초과근무 기록이 있는 의심스러운 사례를 자동으로 탐지합니다.

## 프로젝트 구조

```
src/
  overtime_analyzer/
    __init__.py
    main.py                # 메인 애플리케이션 진입점
    models/
      __init__.py
      data_models.py       # 데이터 모델 클래스
    services/
      __init__.py
      analyzer_service.py  # 분석 서비스
      overtime_processor.py # 초과근무 처리기
      security_processor.py # 보안 출입 기록 처리기
    ui/
      __init__.py
      analyzer_ui.py       # 사용자 인터페이스
    utils/
      __init__.py
      date_utils.py        # 날짜 관련 유틸리티
      file_utils.py        # 파일 관련 유틸리티
tests/
  test_core_functions.py   # 단위 테스트
```

## 주요 기능

- **경비 기록과 초과근무 기록 동시 분석**: 두 데이터 소스를 통합 분석
- **새벽 4시 기준 근무일 구분**: 14일 2시 퇴근은 13일 업무로 계산
- **경비 작동 중 초과근무 기록 자동 감지**: 의심스러운 기록 탐지
- **경비 상태 자동 판단**: '출근/해제'는 경비 해제로, '퇴근/세팅'은 경비 시작으로 해석
- **휴일 근무 여부 자동 감지**: 주말 및 공휴일 근무 표시
- **결과 내보내기**: 분석 결과를 엑셀 파일로 저장

## 설치 및 실행 방법

### 필수 요구사항

- Python 3.7 이상
- PyQt5
- pandas
- openpyxl

### macOS/Linux 사용자

1. 설치 스크립트 실행:

   ```
   ./setup.sh
   ```

2. 프로그램 실행:
   ```
   ./run.sh
   ```

### Windows 사용자

1. 설치 스크립트 실행:

   ```
   setup.bat
   ```

2. 프로그램 실행:
   ```
   run.bat
   ```

### 수동 설치

1. 가상 환경 생성 및 활성화:

   ```
   python -m venv venv
   source venv/bin/activate  # macOS/Linux
   venv\Scripts\activate     # Windows
   ```

2. 필요 패키지 설치:

   ```
   pip install -r requirements.txt
   ```

3. 프로그램 실행:
   ```
   python run_analyzer.py
   ```

## 사용 방법

1. "경비 기록 엑셀 파일 선택" 버튼을 클릭하여 경비 시스템 기록 파일을 선택합니다.
2. "초과근무 기록 엑셀 파일 선택" 버튼을 클릭하여 초과근무 기록 파일을 선택합니다.
3. 필요한 경우 분석할 날짜 범위를 설정합니다.
4. "분석 시작" 버튼을 클릭하여 데이터 분석을 시작합니다.
5. 의심스러운 초과근무 기록이 표에 표시됩니다.
6. "결과 내보내기" 버튼을 클릭하여 분석 결과를 엑셀 파일로 저장합니다.

## 파일 요구사항

### 경비 기록 파일 형식

- '발생일자' 또는 '날짜'가 포함된 열 (A열)
- '발생시각' 또는 '시간'이 포함된 열 (B열)
- '모드', '상태' 또는 '내용'이 포함된 열 (I열)
- 해당 열에 '출근/해제', '퇴근/세팅' 등의 값이 포함되어야 함

### 초과근무 기록 파일 형식

- 3행부터 데이터가 시작됨
- G열: 초과근무일자
- H열: 출근시간
- I열: 퇴근시간
- D열: 성명(직원명)
- 추가 정보: 부서명(A열), 직급(B열), 휴일여부(F열), 근무내용(N열)

## 개발자 정보

### 빌드 방법

실행 파일로 빌드하려면 다음 명령을 실행하세요:

```
python build.py
```

옵션:

- `--console`: 콘솔 창을 표시합니다.
- `--clean-build`: 빌드 전 이전 빌드 파일을 삭제합니다.

### 테스트 실행

단위 테스트를 실행하려면 다음 명령을 사용하세요:

```
python -m unittest discover -s tests
```
