# 사무실 출입 및 초과근무 분석 도구

이 저장소에는 사무실 출입 및 초과근무 기록을 분석하기 위한 두 가지 도구가 포함되어 있습니다.

1. **출입 기록 분석기**: 사무실 출입 기록 엑셀 데이터를 분석하여 비정상적인 출/퇴근 패턴을 찾습니다.
2. **초과근무 분석기**: 경비 기록과 초과근무 기록을 함께 분석하여 경비가 작동 중일 때(사무실에 아무도 없을 때) 초과근무 기록이 있는 의심스러운 사례를 찾습니다.

## 주요 기능

### 출입 기록 분석기

- 출입 기록 엑셀 파일 분석
- 비정상적인 출/퇴근 패턴 자동 감지
- 날짜 범위 필터링
- 의심스러운 날짜만 표시 (출근/퇴근 여러 번 기록된 날짜)
- 분석 결과 엑셀 내보내기
- 열 이름 자동 감지 (발생일자/날짜, 발생시각/시간, 모드/상태/내용)

### 초과근무 분석기

- 경비 기록과 초과근무 기록 동시 분석
- 평일 9:00-18:00를 정규 근무시간으로 간주하고 초과근무 시간 자동 계산
- 새벽 4시를 기준으로 근무일 구분
- 경비 작동 중 초과근무 기록이 있는 의심스러운 사례 자동 감지
- 15분(0.25시간) 이상 중첩된 경우만 의심 사례로 간주

## 사용 방법

### 출입 기록 분석기

1. "파일 선택" 버튼을 클릭하여 출입 기록 엑셀 파일을 선택합니다.
2. 필요한 경우 분석할 날짜 범위를 설정합니다.
3. "분석 시작" 버튼을 클릭하여 데이터 분석을 시작합니다.
4. 의심스러운 날짜가 표에 표시됩니다.
5. "결과 내보내기" 버튼을 클릭하여 분석 결과를 엑셀 파일로 저장합니다.

### 초과근무 분석기

1. "경비 기록 엑셀 파일 선택" 버튼을 클릭하여 경비 시스템 기록 파일을 선택합니다.
2. "초과근무 기록 엑셀 파일 선택" 버튼을 클릭하여 초과근무 기록 파일을 선택합니다.
3. 필요한 경우 분석할 날짜 범위를 설정합니다.
4. "분석 시작" 버튼을 클릭하여 데이터 분석을 시작합니다.
5. 의심스러운 초과근무 기록이 표에 표시됩니다.
6. "결과 내보내기" 버튼을 클릭하여 분석 결과를 엑셀 파일로 저장합니다.

## 파일 요구사항

### 출입 기록 분석기

- 분석할 출입 기록 엑셀 파일은 다음 형식을 따라야 합니다:
  - '발생일자' 또는 '날짜'가 포함된 열 (자동 감지, 기본값: A열)
  - '발생시각' 또는 '시간'이 포함된 열 (자동 감지, 기본값: B열)
  - '모드', '상태' 또는 '내용'이 포함된 열 (자동 감지, 기본값: I열)
  - '출근', '퇴근', '세트', '해제' 등의 값이 포함된 모드 열

### 초과근무 분석기

- 경비 기록 파일은 출입 기록 분석기와 동일한 형식을 따릅니다.
- 초과근무 기록 파일은 다음 형식을 따라야 합니다:
  - '날짜' 또는 '일자'가 포함된 열
  - '시작시간'이 포함된 열
  - '종료시간'이 포함된 열
  - '이름' 또는 '직원'이 포함된 열

## 출입 기록 분석기와 초과근무 분석기 비교

| 특징        | 출입 기록 분석기                     | 초과근무 분석기                                       |
| ----------- | ------------------------------------ | ----------------------------------------------------- |
| 주 기능     | 비정상적인 출/퇴근 패턴 감지         | 경비 작동 중 초과근무 기록 감지                       |
| 필요한 파일 | 출입 기록 파일 하나                  | 경비 기록 파일 + 초과근무 기록 파일                   |
| 초점        | 경비 해제/시작 패턴 이상 감지        | 경비-초과근무 간 불일치 감지                          |
| 자세한 내용 | [출입 기록 분석기 설명서](README.md) | [초과근무 분석기 설명서](README_overtime_analyzer.md) |

## 설치 및 실행

### 방법 1: 실행 파일 사용 (권장)

1. GitHub 릴리스 페이지에서 최신 버전의 실행 파일을 다운로드합니다:
   - `출입기록분석기.exe`: 출입 기록만 분석하는 경우
   - `초과근무분석기.exe`: 경비 기록과 초과근무 기록을 함께 분석하는 경우
2. 다운로드한 파일을 더블클릭하여 실행합니다.

### 방법 2: 소스 코드에서 실행 (개발자용)

1. Python과 필요한 라이브러리를 설치합니다:

   ```
   pip install -r requirements.txt
   ```

2. 원하는 프로그램을 실행합니다:

   ```
   python access_log_analyzer.py  # 출입 기록 분석기
   ```

   또는

   ```
   python overtime_analyzer.py    # 초과근무 분석기
   ```

3. 윈도우용 실행 파일을 빌드하려면:
   ```
   python build.py            # 출입 기록 분석기 빌드
   python build_overtime.py   # 초과근무 분석기 빌드
   ```
